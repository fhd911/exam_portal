{% extends "quiz/base.html" %}
{% block title %}استيراد المتقدمين{% endblock %}

{% block content %}
<div class="card" style="max-width:860px;margin:0 auto;">
  <div class="row" style="align-items:flex-start;">
    <div>
      <h2 style="margin:0;">استيراد المتقدمين (Excel)</h2>
      <div class="mut" style="margin-top:6px;line-height:1.9;">
        الأعمدة المطلوبة داخل شيت <b>participants</b>:
        <div style="margin-top:10px;display:flex;flex-wrap:wrap;gap:8px;">
          <span class="pill ok">national_id</span>
          <span class="pill ok">full_name</span>
          <span class="pill ok">phone_last4</span>
          <span class="pill warn">is_allowed (اختياري)</span>
          <span class="pill warn">has_taken_exam (اختياري)</span>
        </div>
      </div>
    </div>

    <a class="btn secondary" href="{% url 'quiz:staff_manage' %}" style="white-space:nowrap;">رجوع للوحة الإدارة</a>
  </div>

  <div style="height:14px;"></div>

  <form method="post" enctype="multipart/form-data" style="display:grid;gap:12px;">
    {% csrf_token %}

    <div class="card" style="padding:14px;background:rgba(255,255,255,.9);">
      <div class="mut" style="font-weight:900;margin-bottom:10px;">خيارات الاستيراد</div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
        <div>
          <label class="mut" style="font-weight:900;margin-bottom:8px;display:block;">اسم الشيت</label>
          <input type="text" name="sheet_name" value="participants">
        </div>

        <div>
          <label class="mut" style="font-weight:900;margin-bottom:8px;display:block;">ملف Excel</label>
          <input type="file" name="file" accept=".xlsx" required>
        </div>
      </div>

      <div style="height:10px;"></div>

      <label style="display:flex;gap:10px;align-items:center;padding:10px 12px;border:1px solid var(--line);border-radius:16px;background:#fff;">
        <input type="checkbox" name="replace" value="1" style="width:auto;transform:translateY(1px);">
        <span style="font-weight:900;">
          replace=1 (استبدال بدون حذف) — يجعل الجميع غير مسموحين ثم يفعّل المستوردين
        </span>
      </label>

      <label style="display:flex;gap:10px;align-items:center;padding:10px 12px;border:1px solid var(--line);border-radius:16px;background:#fff;margin-top:10px;">
        <input type="checkbox" name="reset_taken" value="1" style="width:auto;transform:translateY(1px);">
        <span style="font-weight:900;">
          reset_taken=1 — تصفير has_taken_exam للمستورَدين فقط
        </span>
      </label>
    </div>

    <div class="row">
      <button class="btn" type="submit">استيراد الآن</button>
      <div class="mut" style="text-align:left;">بعد الاستيراد سيتم تحويلك إلى لوحة الإدارة.</div>
    </div>
  </form>
</div>
{% endblock %}
