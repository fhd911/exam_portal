{% extends "quiz/base.html" %}
{% block title %}استيراد المرشحين{% endblock %}

{% block content %}
<div class="wrap">
  <div class="box">
    <div class="head">
      <div>
        <h2>استيراد المرشحين</h2>
        <p>Excel (.xlsx) — الأعمدة المطلوبة: national_id, full_name, phone_last4, domain</p>
      </div>
      <a class="btn soft" href="{% url 'quiz:staff_manage' %}">رجوع</a>
    </div>

    {% if messages %}
      <div class="msgs">
        {% for m in messages %}
          <div class="msg {{ m.tags|default:"info" }}">{{ m }}</div>
        {% endfor %}
      </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data" class="form">
      {% csrf_token %}

      <div class="grid">
        <div class="f">
          <label>ملف Excel</label>
          <input type="file" name="file" accept=".xlsx" required>
        </div>

        <div class="f">
          <label>اسم الشيت</label>
          <input name="sheet_name" value="participants" placeholder="participants">
        </div>

        <div class="f">
          <label class="chk">
            <input type="checkbox" name="replace" value="1">
            <span>استبدال التسجيلات (يوقف الكل ثم يفعّل الموجود)</span>
          </label>
        </div>

        <div class="f">
          <label class="chk">
            <input type="checkbox" name="reset_taken" value="1">
            <span>إعادة تعيين القفل (للمرشحين المستوردين فقط)</span>
          </label>
        </div>
      </div>

      <div class="foot">
        <button class="btn" type="submit">استيراد</button>
      </div>
    </form>

    <div class="note">
      <div class="t">تنسيق الأعمدة</div>
      <ul>
        <li><b>domain</b>: deputy / counselor / activity أو عربي (وكيل/موجه/نشاط)</li>
        <li><b>phone_last4</b>: آخر 4 أرقام فقط</li>
        <li>اختياري: <b>person_allowed</b> و <b>is_allowed</b></li>
      </ul>
    </div>
  </div>
</div>

<style>
  .wrap{max-width:980px;margin:0 auto;padding:12px 10px 44px}
  .box{background:#fff;border:1px solid rgba(231,238,246,.95);border-radius:22px;padding:14px;box-shadow:0 16px 34px rgba(2,44,34,.06)}
  .head{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;align-items:flex-start}
  h2{margin:0;font-size:18px;font-weight:1200}
  p{margin:6px 0 0;color:var(--mut);font-weight:1000;line-height:1.9}
  .btn{border:0;border-radius:999px;padding:9px 12px;font-weight:1200;cursor:pointer;text-decoration:none;display:inline-flex;align-items:center;gap:8px;background:#0ea5e9;color:#fff}
  .btn.soft{background:#eef6ff;color:#0b4c7a;border:1px solid rgba(15,23,42,.08)}

  .msgs{display:grid;gap:8px;margin:12px 0}
  .msg{padding:10px 12px;border-radius:16px;border:1px solid rgba(231,238,246,.95);background:#fafcff;font-weight:1100}

  .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}
  .f label{display:block;font-size:12px;color:var(--mut);font-weight:1100;margin:0 2px 6px}
  .f input[type="file"], .f input{width:100%;border-radius:14px;border:1px solid rgba(15,23,42,.10);padding:10px;font-weight:1000}
  .chk{display:flex;gap:10px;align-items:flex-start;margin-top:6px;font-weight:1100;line-height:1.9;color:#0f172a}
  .foot{display:flex;justify-content:flex-end;margin-top:12px}
  .note{margin-top:14px;border-radius:18px;border:1px solid rgba(231,238,246,.95);background:#fafcff;padding:12px}
  .note .t{font-weight:1200}
  .note ul{margin:8px 0 0;line-height:1.9}
</style>
{% endblock %}
